<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenida - Pokédex</title>
    <link rel="stylesheet" href="welcomeStyle.css">
</head>
<body>
    <div id="header-placeholder"></div>
    
    <main class="main-content">
        <div class="welcome-container">
            <h2>¡Bienvenido, <span id="userName"></span>!</h2>
            <p>Explora los 151 Pokémon originales</p>
            
            <div class="pokedex-container">
                <div class="pokemon-list-container">
                    <h3>Lista de Pokémon</h3>
                    <div id="pokemon-list" class="pokemon-list">
                        <p>Cargando lista...</p>
                    </div>
                </div>
                
                <div class="pokemon-detail-container">
                    <h3>Detalles del Pokémon</h3>
                    <div id="pokemon-detail" class="pokemon-detail">
                        <p>Selecciona un Pokémon de la lista</p>
                    </div>
                </div>
            </div>
            
            <button onclick="cerrarSesion()" class="logout-btn">Cerrar Sesión</button>
        </div>
    </main>
    
    <div id="footer-placeholder"></div>

    <script src="auth.js"></script>
    <script>
        const session = getCurrentSession();
        if (!session) {
            window.location.href = 'login.html';
        } else {
            document.getElementById('userName').textContent = session.nombre;
        }

        function cerrarSesion() {
            if (confirm('¿Estás seguro de que deseas cerrar sesión?')) {
                logoutUser();
                window.location.href = 'login.html';
            }
        }

        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-placeholder').innerHTML = data;
            });

        fetch('footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer-placeholder').innerHTML = data;
            });

        async function cargarListaPokemon() {
            const listContainer = document.getElementById('pokemon-list');
            listContainer.innerHTML = '';
            
            for (let i = 1; i <= 151; i++) {
                const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${i}`);
                const pokemon = await response.json();
                
                const item = document.createElement('div');
                item.className = 'pokemon-item';
                item.innerHTML = `<span>#${pokemon.id}</span> ${pokemon.name.charAt(0).toUpperCase() + pokemon.name.slice(1)}`;
                item.onclick = () => mostrarDetalle(pokemon.id);
                listContainer.appendChild(item);
            }
        }

        async function mostrarDetalle(id) {
            const detailContainer = document.getElementById('pokemon-detail');
            detailContainer.innerHTML = '<p>Cargando...</p>';
            
            const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${id}`);
            const pokemon = await response.json();
            
            const tipos = pokemon.types.map(t => t.type.name).join(', ');
            const ataques = pokemon.moves.slice(0, 8).map(m => m.move.name).join(', ');
            
            let statsHTML = '';
            pokemon.stats.forEach(stat => {
                statsHTML += `<div class="stat-row"><span>${stat.stat.name}:</span><span>${stat.base_stat}</span></div>`;
            });
            
            detailContainer.innerHTML = `
                <img src="${pokemon.sprites.other['official-artwork'].front_default}" alt="${pokemon.name}">
                <h4>${pokemon.name.toUpperCase()}</h4>
                <p class="pokemon-id">#${pokemon.id}</p>
                <div class="detail-section">
                    <p><strong>Tipo:</strong> ${tipos}</p>
                    <p><strong>Altura:</strong> ${pokemon.height / 10} m</p>
                    <p><strong>Peso:</strong> ${pokemon.weight / 10} kg</p>
                </div>
                <div class="detail-section">
                    <p><strong>Estadísticas:</strong></p>
                    <div class="stats-container">${statsHTML}</div>
                </div>
                <div class="detail-section">
                    <p><strong>Ataques:</strong></p>
                    <p class="attacks">${ataques}</p>
                </div>
            `;
            
            document.querySelectorAll('.pokemon-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.pokemon-item')[id - 1].classList.add('active');
        }

        cargarListaPokemon();
    </script>
</body>
</html>